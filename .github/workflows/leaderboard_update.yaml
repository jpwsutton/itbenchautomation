name: Leaderboard Update
on:
  workflow_dispatch

jobs:
  update_leaderboard:
    runs-on: self-hosted
    environment: onboarding
    name: Update the Leaderboard
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
      - name: Pull Leaderboard data
        id: get-leaderboard-data
        env:
          ITBENCH_API: ${{vars.ITBENCH_API}}
          ITBENCH_API_TOKEN: ${{ secrets.ITBENCH_API_TOKEN }}
        run: |
          echo "Requesting Leaderboard data from API"

          leaderboard_md=$(python ./.github/workflows/leaderboard.py)

          echo "leaderboard_md=$leaderboard_md" >> "$GITHUB_OUTPUT"

          echo "Complete"
      - name: generate-readme
        id: generate-readme
        env:
          CONTENT: |
            # IT Bench Leaderboard

            ${{leaderboard_md}}
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

          echo "$CONTENT" > LEADERBOARD.md

          git checkout main

          git add LEADERBOARD.md

          git commit -m "Update leaderboard"

          git push origin main


          



      
      
